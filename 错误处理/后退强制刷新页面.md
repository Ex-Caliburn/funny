# 后退强制刷新页面

## 前言

后台商品选择是错误，导致展示和实际商品不一致

### persisted

PageTransitionEvent.persisted

```js
window.addEventListener('pageshow', function(event) {
  if (event.persisted) {
    console.log('Page was loaded from cache.');
  }
});
```

### performance

```js
  window.performance.navigation.type === 2 // 已经废弃

  perfEntries[0].type === "back_forward" // 判断是浏览器前进和后退
```

### 完美解决方案

```js
window.addEventListener( "pageshow", function ( event ) {
  let perfEntries = performance.getEntriesByType("navigation");
  let historyTraversal = event.persisted || (perfEntries[0].type === "back_forward")

  if ( historyTraversal ) {
    // Handle page restore.
    window.location.reload();
  }
});
```

## 总结

### 参考文献

1. <https://developer.mozilla.org/zh-CN/docs/Web/API/PageTransitionEvent/persisted>
2. <https://stackoverflow.com/questions/43043113/how-to-force-reloading-a-page-when-using-browser-back-button/43043658#43043658>
