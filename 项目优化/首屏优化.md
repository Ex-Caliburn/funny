# 首屏优化

## 前言

页面首次渲染时间就是产品的生命线

分为三个部分

1. 下载
2. 解析
3. 交互

### 下载

1. css js 内联
2. 减少关键资源大小
3. 设置js deffer异步， css异步加载
4. DNS优化，dns-prefetch
5. Http 缓存
6. CDN，减少RRT的时间，RTT（round trip time）。通常一个HTTP的数据包在14kb左右。
7. gzip，压缩资源

### 解析

1. css位于body上方，js位于body下方，减少js 对 DOM渲染的影响
2. 尽量少用js操作动画
3. SSR，减少网络下载和渲染的过程
4. 使用GPU加速，使用CSS transform 动画

### 交互

1. 减少js执行时间， webWork处理无dom无关的大量的计算
2. 减少重绘，重排
3. 不要在修改 DOM 结构时再去查询一些相关值。
4. 合理利用 CSS 合成动画 （标识 will-change 单独生成一个图层）
5. 避免频繁的垃圾回收 （尽量避免临时垃圾数据，优化存储结构，避免小颗粒对象产生）
6. 把多次修改dom操作，放到一个时间段，参考vue，回放到微任务队列，等主线程任务空闲再去执行，这样异步执行，也不会阻塞dom，还有就是利用虚拟dom，把多次修改现在Vnode上实现，然后diff，只需要修改变化的dom，减少重绘重排

### 用户体验方面

1. 骨架图
2. loading提示

### 资源优化

1. 使用字体图标 减少 HTTP 请求次数
2. webp
3. svg

## 总结

## 参考文献
