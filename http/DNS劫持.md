# DNS劫持

## 前言

DNS劫持现象：你输入一个google.com网址，出来的是百度的页面

HTTP劫持现象：访问着github的页面，右下角出现了一个格格不入的广告弹窗

好比：

DNS劫持是你想去机场的时候，把你给丢到火车站。 HTTP劫持是你去机场途中，有人给你塞小广告、

![alt](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/11/5/16e3b1ca4bc18bd8~tplv-t2oaga2asx-watermark.awebp)

### 几种DNS劫持方法

1. 本机DNS劫持
攻击者通过某些手段使用户的计算机感染上木马病毒，或者恶意软件之后，恶意修改本地DNS配置，比如修改本地hosts文件，缓存等
2. 路由DNS劫持
很多用户默认路由器的默认密码，攻击者可以侵入到路由管理员账号中，修改路由器的默认配置
3. 攻击DNS服务器
直接攻击DNS服务器，例如对DNS服务器进行DDOS攻击，可以是DNS服务器宕机，出现异常请求，还可以利用某些手段感染dns服务器的缓存，使给用户返回来的是恶意的ip地址

### DNS的防范

1. 加强本地计算机病毒检查，开启防火墙等，防止恶意软件，木马病毒感染计算机
2. 改变路由器默认密码，防止攻击者修改路由器的DNS配置指向恶意的DNS服务器
3. 企业的话可以准备两个以上的域名，一旦一个域名挂掉，还可以使用另一个
4. 用HTTP DNS 代替 Local DNS

对于DNS劫持，往往单靠个人设置很难解决，如果已经出现了劫持现象的话，对电脑进去杀毒，清理，检查hosts文件，核查网络设置的DNS配置（可以使用写公共的DNS服务器）

### 用HTTP DNS

 防止域名劫持
由于 HttpDns 是通过 IP 直接请求 HTTP 获取服务器 A 记录地址，不存在向本地运营商询问 domain 解析过程，所以从根本避免了劫持问题。

## 总结

为什么DNS采用UDP协议 ？
TCP通信过程太复杂并且开销大，一次TCP交换需要9个包： 三个连接包，四个断开包，一个request包，一个响应包。

UDP通信过程简单，只需要一个查询包和一个响应包。

 主机是如何知道DNS服务器地的IP地址的？
通过DHCP动态获得，或者手工配置的。
DHCP协议： DHCP（Dynamic Host Configuration Protocol，动态主机配置协议）通常被应用在大型的局域网络环境中，主要作用是集中的管理、分配IP地址，使网络环境中的主机动态的获得IP地址、Gateway地址、DNS服务器地址等信息，并能够提升地址的使用率。

### 参考文献

1. <https://juejin.cn/post/6844903863623876622#heading-10>
